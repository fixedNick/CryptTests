Получаем контекст, если не удалось получить создаем новый с CRYPT_NEWKEYSET
Генерируем пару ключей (ассиметричное шифрование)
Генерируем сессионный ключ (симметричное шифрование) 
Берем исходный текст, шифруем его сессионным ключом
Сессионный ключ шифруем публичным ключом из пары
... передаем шифрованный текст + шифрованный сессионный ключ ...
Дешифруем сессионный ключ приватным ключом из пары
Дешифруем текст сессионным ключом